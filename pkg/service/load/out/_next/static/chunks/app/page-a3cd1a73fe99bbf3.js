(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2769:(e,t,a)=>{Promise.resolve().then(a.bind(a,7704))},7704:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>td});var s=a(5155),r=a(2115),n=a(5695),l=a(9708),i=a(2085),o=a(2596),d=a(9688);function c(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,d.QP)((0,o.$)(t))}let u=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function m(e){let{className:t,variant:a,size:r,asChild:n=!1,...i}=e,o=n?l.DX:"button";return(0,s.jsx)(o,{"data-slot":"button",className:c(u({variant:a,size:r,className:t})),...i})}let h=r.createContext(null);function x(){let e=r.useContext(h);if(!e)throw Error("useSidebar must be used within a SidebarProvider");return e}function g(e){let{children:t}=e,[a,n]=r.useState(!0);return(0,s.jsx)(h.Provider,{value:{isOpen:a,toggle:()=>n(!a)},children:(0,s.jsx)("div",{className:"flex h-screen",children:t})})}function p(e){let{children:t,className:a}=e,{isOpen:r}=x();return(0,s.jsx)("div",{"data-sidebar":!0,className:c("bg-sidebar border-r border-sidebar-border transition-all duration-300",r?"w-64":"w-16",a),children:t})}function f(e){let{children:t,className:a}=e;return(0,s.jsx)("div",{className:c("p-4 border-b border-sidebar-border",a),children:t})}function v(e){let{children:t,className:a}=e;return(0,s.jsx)("div",{className:c("flex-1 overflow-y-auto p-4",a),children:t})}function b(e){let{className:t}=e,{toggle:a}=x();return(0,s.jsx)(m,{onClick:a,variant:"ghost",size:"sm",className:c("p-1 cursor-pointer",t),children:(0,s.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}function j(e){let{children:t,className:a}=e;return(0,s.jsx)("main",{className:c("flex-1 overflow-auto",a),children:t})}var y=a(5604);let N=y.Ik({step_name:y.Yj(),step_count:y.ai().int().nonnegative(),step_failure:y.ai().int().nonnegative(),step_response_time:y.YO(y.ai().nonnegative()),step_bytes_in:y.ai().int().nonnegative(),step_bytes_out:y.ai().int().nonnegative()}),w=y.Ik({vu_id:y.ai().int().min(0),ts_exec_count:y.ai().int().nonnegative(),ts_exec_failure:y.ai().int().nonnegative(),ts_exec_time:y.YO(y.ai().nonnegative()),steps:y.YO(N)}),_=y.Ik({Target:y.ai().int().positive(),Duration:y.Yj()}),S=y.Ik({Metric:y.Yj(),Condition:y.Yj(),Severity:y.Yj(),Value:y.ai()}),k=y.Ik({Profile:y.Yj(),VUs:y.ai().int().positive(),Duration:y.Yj(),RPS:y.ai().int().positive(),Stages:y.YO(_).optional(),Thresholds:y.YO(S).optional()}),A=y.Ik({check_id:y.Yj(),check_name:y.Yj(),status:y.k5(["passed","failed","warning"]),severity:y.Yj(),description:y.Yj(),details:y.Yj().optional(),recommendation:y.Yj().optional(),step_name:y.Yj(),step_method:y.Yj(),step_url:y.Yj(),status_code:y.ai().int().optional(),target:y.k5(["request","response"])}),C=y.Ik({step_name:y.Yj(),step_method:y.Yj(),step_url:y.Yj(),results:y.YO(A),passed:y.ai().int().nonnegative(),failed:y.ai().int().nonnegative(),warnings:y.ai().int().nonnegative()}),I=y.Ik({test_suite:y.Yj(),timestamp:y.Yj(),total_checks:y.ai().int().nonnegative(),passed:y.ai().int().nonnegative(),failed:y.ai().int().nonnegative(),warnings:y.ai().int().nonnegative(),steps:y.YO(C),summary:y.g1(y.Yj(),y.ai().int().nonnegative())}),P=y.Ik({id:y.Yj().min(1),url:y.Yj().url(),title:y.Yj().min(1),created_at:y.Yj(),description:y.Yj(),load_options:k,security_report:I.optional(),end_at:y.Yj().optional()}),T=y.Ik({timestamp:y.ai().int().positive(),value:y.ai().nonnegative()}),E=y.Ik({timestamp:y.ai().int().positive(),avg_latency:y.ai().nonnegative()}),z=y.Ik({overall:y.YO(E),perStep:y.g1(y.Yj(),y.YO(T)),perVU:y.g1(y.Yj(),y.YO(T))});y.YO(P);let O=y.YO(w);y.Ik({dashboardData:y.g1(y.Yj(),O),chartHistories:y.g1(y.Yj(),z),dashboardStopTimes:y.g1(y.Yj(),y.Yj()),dashboardCloseTimes:y.g1(y.Yj(),y.Yj()).optional(),dashboardOpenedStatus:y.g1(y.Yj(),y.zM()).optional()});var D=a(464),Y=a(574),M=a(5525);function V(e){let{selectedDashboard:t,currentView:a="dashboard",onViewChange:r}=e,{isOpen:n}=x(),l=e=>{null==r||r(e)},i=null==t?void 0:t.security_report;return(0,s.jsxs)(p,{children:[(0,s.jsx)(f,{children:(0,s.jsx)("div",{className:"flex items-center gap-2 w-full",children:(0,s.jsxs)("div",{className:"p-2 text-orange-900 h-full w-full flex items-center ".concat(n?"ml-4":"justify-center"),children:[(0,s.jsx)(D.A,{className:"h-4 w-4"}),n&&(0,s.jsx)("h2",{className:"font-semibold text-lg ml-2",children:"KLT Dashboard"})]})})}),(0,s.jsx)(v,{children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(m,{onClick:()=>l("dashboard"),variant:"dashboard"===a?"default":"ghost",className:"w-full ".concat(n?"justify-start":"justify-center"," gap-2 ").concat("dashboard"===a?"bg-orange-100 text-orange-900 hover:bg-orange-200":"text-orange-900 hover:bg-orange-100"),children:[(0,s.jsx)(Y.A,{className:"h-4 w-4"}),n&&"Dashboard"]}),(0,s.jsxs)(m,{onClick:()=>l("security"),disabled:!i,variant:"security"===a?"default":"ghost",className:"w-full ".concat(n?"justify-start":"justify-center"," gap-2 ").concat("security"===a?"bg-orange-100 text-orange-900 hover:bg-orange-200":i?"text-orange-900 hover:bg-orange-100":"text-orange-400 cursor-not-allowed"),children:[(0,s.jsx)(M.A,{className:"h-4 w-4"}),n&&(0,s.jsxs)("span",{children:["Security Report",!i&&(0,s.jsx)("span",{className:"text-xs ml-1",children:"(N/A)"})]})]}),n&&i&&(null==t?void 0:t.security_report)&&(0,s.jsxs)("div",{className:"mt-4 p-3 bg-orange-50 rounded-md",children:[(0,s.jsx)("div",{className:"text-xs font-medium text-orange-900 mb-2",children:"Security Summary"}),(0,s.jsxs)("div",{className:"space-y-1 text-xs text-orange-700",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Total Checks:"}),(0,s.jsx)("span",{className:"font-medium",children:t.security_report.total_checks})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Passed:"}),(0,s.jsx)("span",{className:"font-medium text-green-600",children:t.security_report.passed})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Failed:"}),(0,s.jsx)("span",{className:"font-medium text-red-600",children:t.security_report.failed})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Warnings:"}),(0,s.jsx)("span",{className:"font-medium text-yellow-600",children:t.security_report.warnings})]})]})]})]})})]})}let R=(0,r.createContext)(void 0);function U(e){let{children:t}=e,[a,n]=(0,r.useState)(null);return(0,s.jsx)(R.Provider,{value:{selectedDashboard:a,setSelectedDashboard:n},children:t})}function L(){let e=(0,r.useContext)(R);if(void 0===e)throw Error("useDashboard must be used within a DashboardProvider");return e}function K(e){let{lttoken:t,currentVUCount:a=0,stopped:n=!1,stopTime:l}=e,i=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0,[s,n]=(0,r.useState)("0s");return(0,r.useEffect)(()=>{if(!e)return;if(t&&a)return void n(a);if(t)return void n("0s");let s=()=>{let t=new Date(e).getTime(),a=Math.max(0,Math.floor((Date.now()-t)/1e3)),s=Math.floor(a/3600),r=Math.floor(a%3600/60),l=a%60;s>0?n("".concat(s,"h ").concat(r,"m ").concat(l,"s")):r>0?n("".concat(r,"m ").concat(l,"s")):n("".concat(l,"s"))};s();let r=setInterval(s,1e3);return()=>clearInterval(r)},[e,t,a]),s}(null==t?void 0:t.created_at,n,l);if(!t)return(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:(0,s.jsx)(F,{children:(0,s.jsxs)(J,{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-400",children:"--"}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Select a dashboard"})]})})});let o=[{label:"Profile",value:t.load_options.Profile,color:"text-gray-600"},{label:"Active VUs",value:"".concat(a," / ").concat(t.load_options.VUs),color:"text-gray-600"},{label:"Target Duration",value:t.load_options.Duration,color:"text-gray-600"},{label:n?"Final Runtime":"Elapsed Time",value:n?l||"Stopped":i,color:n?"text-red-600":"text-blue-600"},{label:"Target RPS",value:t.load_options.RPS.toLocaleString(),color:"text-gray-600"},{label:"Status",value:n?"Completed":"Running",color:n?"text-red-600":"text-green-600"}];return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(Y.A,{className:"h-10 w-10 text-orange-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-orange-900",children:t.title}),(0,s.jsx)("p",{className:"text-orange-700 text-sm mt-1",children:t.description}),(0,s.jsxs)("p",{className:"text-orange-600 text-xs mt-2",children:["ID: ",t.id]})]})]}),(0,s.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(n?"bg-red-100 text-red-800":"bg-green-100 text-green-800"),children:n?"Completed":"Running"})]})}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:o.map(e=>(0,s.jsx)(F,{children:(0,s.jsxs)(J,{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold ".concat(e.color),children:e.value}),(0,s.jsx)("div",{className:"text-sm text-orange-600",children:e.label})]})},e.label))})]})}function F(e){let{children:t,className:a=""}=e;return(0,s.jsx)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg shadow-sm ".concat(a),children:t})}function J(e){let{children:t,className:a=""}=e;return(0,s.jsx)("div",{className:"p-4 ".concat(a),children:t})}var G=a(6268),H=a(1032);function q(e){let{data:t,columns:a,enableRowSelection:s=!0,defaultPageIndex:n,defaultPageSize:l,getRowId:i}=e,[o,d]=r.useState({}),[c,u]=r.useState({}),[m,h]=r.useState([]),[x,g]=r.useState([]),[p,f]=r.useState({pageIndex:null!=n?n:0,pageSize:null!=l?l:10});return(0,G.N4)({data:t,columns:a,state:{sorting:x,columnVisibility:c,rowSelection:o,columnFilters:m,pagination:p},enableRowSelection:s,getRowId:null!=i?i:e=>e.id.toString(),onRowSelectionChange:d,onSortingChange:g,onColumnFiltersChange:h,onColumnVisibilityChange:u,onPaginationChange:f,getCoreRowModel:(0,H.HT)(),getFilteredRowModel:(0,H.hM)(),getPaginationRowModel:(0,H.kW)(),getSortedRowModel:(0,H.h5)(),getFacetedRowModel:(0,H.kQ)(),getFacetedUniqueValues:(0,H.oS)()})}var B=a(17);function W(e){let{className:t,...a}=e;return(0,s.jsx)(B.bL,{"data-slot":"tabs",className:c("flex flex-col gap-2",t),...a})}function Q(e){let{className:t,...a}=e;return(0,s.jsx)(B.B8,{"data-slot":"tabs-list",className:c("bg-orange-200/60 text-orange-700 inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...a})}function X(e){let{className:t,...a}=e;return(0,s.jsx)(B.l9,{"data-slot":"tabs-trigger",className:c("data-[state=active]:bg-orange-50 data-[state=active]:text-orange-900 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring data-[state=active]:border-orange-300 data-[state=active]:bg-orange-100 text-orange-800 hover:bg-orange-100/50 hover:text-orange-900 inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...a})}var Z=a(5143),$=a(1206),ee=a(402);function et(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:c("w-full caption-bottom text-sm",t),...a})})}function ea(e){let{className:t,...a}=e;return(0,s.jsx)("thead",{"data-slot":"table-header",className:c("[&_tr]:border-b",t),...a})}function es(e){let{className:t,...a}=e;return(0,s.jsx)("tbody",{"data-slot":"table-body",className:c("[&_tr:last-child]:border-0",t),...a})}function er(e){let{className:t,...a}=e;return(0,s.jsx)("tr",{"data-slot":"table-row",className:c("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function en(e){let{className:t,...a}=e;return(0,s.jsx)("th",{"data-slot":"table-head",className:c("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function el(e){let{className:t,...a}=e;return(0,s.jsx)("td",{"data-slot":"table-cell",className:c("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}var ei=a(8266);function eo(e){let{row:t}=e,{transform:a,transition:r,setNodeRef:n,isDragging:l}=(0,ee.gl)({id:t.original.id});return(0,s.jsx)(er,{"data-state":t.getIsSelected()&&"selected","data-dragging":l,ref:n,className:"relative z-0 data-[dragging=true]:z-10 data-[dragging=true]:opacity-80",style:{transform:ei.Ks.Transform.toString(a),transition:r},children:t.getVisibleCells().map(e=>(0,s.jsx)(el,{children:(0,G.Kv)(e.column.columnDef.cell,e.getContext())},e.id))})}function ed(e){let{table:t,columns:a,dndEnabled:n=!1,onReorder:l}=e,i=t.getRowModel().rows.map(e=>Number(e.id)),o=r.useId(),d=(0,Z.FR)((0,Z.MS)(Z.cA,{}),(0,Z.MS)(Z.IG,{}),(0,Z.MS)(Z.uN,{})),c=(0,s.jsxs)(et,{children:[(0,s.jsx)(ea,{className:"bg-orange-100 sticky top-0 z-10",children:t.getHeaderGroups().map(e=>(0,s.jsx)(er,{children:e.headers.map(e=>(0,s.jsx)(en,{colSpan:e.colSpan,children:e.isPlaceholder?null:(0,G.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,s.jsx)(es,{className:"**:data-[slot=table-cell]:first:w-8",children:function(e){let{table:t,columns:a,dndEnabled:r,dataIds:n}=e;return t.getRowModel().rows.length?r?(0,s.jsx)(ee.gB,{items:n,strategy:ee._G,children:t.getRowModel().rows.map(e=>(0,s.jsx)(eo,{row:e},e.id))}):t.getRowModel().rows.map(e=>(0,s.jsx)(er,{"data-state":e.getIsSelected()&&"selected",children:e.getVisibleCells().map(e=>(0,s.jsx)(el,{children:(0,G.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,s.jsx)(er,{children:(0,s.jsx)(el,{colSpan:a.length,className:"h-24 text-center",children:"No results."})})}({table:t,columns:a,dndEnabled:n,dataIds:i})})]});return n?(0,s.jsx)(Z.Mp,{collisionDetection:Z.fp,modifiers:[$.FN],onDragEnd:function(e){let{active:a,over:s}=e;if(a&&s&&a.id!==s.id&&l){let e=i.indexOf(a.id),r=i.indexOf(s.id);l((0,ee.be)(t.options.data,e,r))}},sensors:d,id:o,children:c}):c}var ec=a(2278),eu=a(2355),em=a(3052),eh=a(2767),ex=a(968);function eg(e){let{className:t,...a}=e;return(0,s.jsx)(ex.b,{"data-slot":"label",className:c("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}var ep=a(1918),ef=a(6474),ev=a(5196),eb=a(7863);function ej(e){let{...t}=e;return(0,s.jsx)(ep.bL,{"data-slot":"select",...t})}function ey(e){let{...t}=e;return(0,s.jsx)(ep.WT,{"data-slot":"select-value",...t})}function eN(e){let{className:t,size:a="default",children:r,...n}=e;return(0,s.jsxs)(ep.l9,{"data-slot":"select-trigger","data-size":a,className:c("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[r,(0,s.jsx)(ep.In,{asChild:!0,children:(0,s.jsx)(ef.A,{className:"size-4 opacity-50"})})]})}function ew(e){let{className:t,children:a,position:r="popper",...n}=e;return(0,s.jsx)(ep.ZL,{children:(0,s.jsxs)(ep.UC,{"data-slot":"select-content",className:c("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[(0,s.jsx)(eS,{}),(0,s.jsx)(ep.LM,{className:c("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,s.jsx)(ek,{})]})})}function e_(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(ep.q7,{"data-slot":"select-item",className:c("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,s.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(ep.VF,{children:(0,s.jsx)(ev.A,{className:"size-4"})})}),(0,s.jsx)(ep.p4,{children:a})]})}function eS(e){let{className:t,...a}=e;return(0,s.jsx)(ep.PP,{"data-slot":"select-scroll-up-button",className:c("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(eb.A,{className:"size-4"})})}function ek(e){let{className:t,...a}=e;return(0,s.jsx)(ep.wn,{"data-slot":"select-scroll-down-button",className:c("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(ef.A,{className:"size-4"})})}function eA(e){let{table:t}=e;return(0,s.jsx)("div",{className:"flex items-center justify-between px-4",children:(0,s.jsxs)("div",{className:"flex w-full items-center gap-8 lg:w-fit",children:[(0,s.jsxs)("div",{className:"hidden items-center gap-2 lg:flex",children:[(0,s.jsx)(eg,{htmlFor:"rows-per-page",className:"text-sm font-medium",children:"Rows per page"}),(0,s.jsxs)(ej,{value:"".concat(t.getState().pagination.pageSize),onValueChange:e=>t.setPageSize(Number(e)),children:[(0,s.jsx)(eN,{className:"h-8 w-[70px] bg-orange-50 border border-orange-200 hover:bg-orange-100",id:"rows-per-page",children:(0,s.jsx)(ey,{placeholder:t.getState().pagination.pageSize})}),(0,s.jsx)(ew,{side:"top",className:"bg-orange-50 border border-orange-200 shadow-lg",children:[10,20,30,40,50].map(e=>(0,s.jsx)(e_,{value:"".concat(e),className:"hover:bg-orange-100",children:e},e))})]})]}),(0,s.jsxs)("div",{className:"flex w-fit items-center justify-center text-sm font-medium",children:["Page ",t.getState().pagination.pageIndex+1," of ",t.getPageCount()]}),(0,s.jsxs)("div",{className:"ml-auto flex items-center gap-2 lg:ml-0",children:[(0,s.jsxs)(m,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>t.setPageIndex(0),disabled:!t.getCanPreviousPage(),children:[(0,s.jsx)("span",{className:"sr-only",children:"Go to first page"}),(0,s.jsx)(ec.A,{})]}),(0,s.jsxs)(m,{variant:"outline",className:"size-8",size:"icon",onClick:()=>t.previousPage(),disabled:!t.getCanPreviousPage(),children:[(0,s.jsx)("span",{className:"sr-only",children:"Go to previous page"}),(0,s.jsx)(eu.A,{})]}),(0,s.jsxs)(m,{variant:"outline",className:"size-8",size:"icon",onClick:()=>t.nextPage(),disabled:!t.getCanNextPage(),children:[(0,s.jsx)("span",{className:"sr-only",children:"Go to next page"}),(0,s.jsx)(em.A,{})]}),(0,s.jsxs)(m,{variant:"outline",className:"hidden size-8 lg:flex",size:"icon",onClick:()=>t.setPageIndex(t.getPageCount()-1),disabled:!t.getCanNextPage(),children:[(0,s.jsx)("span",{className:"sr-only",children:"Go to last page"}),(0,s.jsx)(eh.A,{})]})]})]})})}function eC(e){if(!Array.isArray(e)||0===e.length)return"-";let t=[...e].sort((e,t)=>e-t),a=Math.floor(.95*(t.length-1));return(t[a]/1e6).toFixed(2)}function eI(e){if(!Array.isArray(e)||0===e.length)return"-";let t=[...e].sort((e,t)=>e-t),a=Math.floor(.9*(t.length-1));return(t[a]/1e6).toFixed(2)}function eP(e){if(!Array.isArray(e)||0===e.length)return"-";let t=[...e].sort((e,t)=>e-t),a=Math.floor(.99*(t.length-1));return(t[a]/1e6).toFixed(2)}function eT(e){return"number"!=typeof e||isNaN(e)?"-":(e/1048576).toFixed(2)}function eE(e){let{data:t,isCompleted:a=!1}=e,[n,l]=r.useState(()=>null!=t?t:[]),[i,o]=r.useState("virtual-users"),[d,c]=r.useState(()=>null!=t?t:[]),[u,m]=r.useState(()=>(null!=t?t:[]).flatMap(e=>Array.isArray(e.steps)?e.steps.map(t=>({...t,vu_id:e.vu_id})):[]));r.useEffect(()=>{console.log("DataTable updating with data:",(null==t?void 0:t.length)||0,"records"),l(null!=t?t:[]),c(null!=t?t:[]),m((null!=t?t:[]).flatMap(e=>Array.isArray(e.steps)?e.steps.map(t=>({...t,vu_id:e.vu_id})):[]))},[t]),r.useEffect(()=>{"virtual-users"===i?c(n):"steps"===i&&m(n.flatMap(e=>Array.isArray(e.steps)?e.steps.map(t=>({...t,vu_id:e.vu_id})):[]))},[i,n]);let h=r.useMemo(()=>{let e={},t={};return n.forEach(a=>{Array.isArray(a.steps)&&a.steps.forEach(a=>{let s=a.step_name;if(s&&(e[s]||(e[s]={step_name:s,step_count:0,step_failure:0,step_response_time:[],step_bytes_in:0,step_bytes_out:0,step_response_time_averages:[]},t[s]=[]),e[s].step_count+="number"==typeof a.step_count?a.step_count:0,e[s].step_failure+="number"==typeof a.step_failure?a.step_failure:0,e[s].step_bytes_in+="number"==typeof a.step_bytes_in?a.step_bytes_in:0,e[s].step_bytes_out+="number"==typeof a.step_bytes_out?a.step_bytes_out:0,Array.isArray(a.step_response_time)&&a.step_response_time.length>0)){e[s].step_response_time.push(...a.step_response_time);let r=a.step_response_time.reduce((e,t)=>e+t,0)/a.step_response_time.length;t[s].push(r)}})}),Object.keys(e).forEach(a=>{e[a].step_response_time_averages=t[a]}),Object.values(e)},[n]);r.useEffect(()=>{"virtual-users"===i?c(n):"steps"===i&&m(h)},[i,h]);let x=[{accessorKey:"vu_id",header:"ID"},{accessorKey:"ts_exec_count",header:"TSExecCount"},{accessorKey:"ts_exec_failure",header:"TSExecFailure"},{accessorKey:"steps",header:"StepExecCount",cell:e=>{let{row:t}=e;return Array.isArray(t.original.steps)?t.original.steps.reduce((e,t)=>e+("number"==typeof t.step_count?t.step_count:0),0):"-"}},{accessorKey:"ts_exec_time",header:"AvgTSExecTime(ms)",cell:e=>{let{row:t}=e;var a=t.original.ts_exec_time;return Array.isArray(a)&&0!==a.length?(a.reduce((e,t)=>e+t,0)/a.length/1e6).toFixed(2):"-"}},{accessorKey:"ts_exec_time_p90",header:"P90TSExecTime(ms)",cell:e=>{let{row:t}=e;return eI(t.original.ts_exec_time)}},{accessorKey:"ts_exec_time_p95",header:"P95TSExecTime(ms)",cell:e=>{let{row:t}=e;return eC(t.original.ts_exec_time)}},{accessorKey:"ts_exec_time_p99",header:"P99TSExecTime(ms)",cell:e=>{let{row:t}=e;return eP(t.original.ts_exec_time)}}],g=[{accessorKey:"step_name",header:"Step Name"},{accessorKey:"step_count",header:"Count(All VUs)",cell:e=>{var t;let{row:a}=e;return null!=(t=a.original.step_count)?t:"-"}},{accessorKey:"step_failure",header:"Failure(All VUs)",cell:e=>{var t;let{row:a}=e;return null!=(t=a.original.step_failure)?t:"-"}},{accessorKey:"step_bytes_in",header:"BytesIn(MB)",cell:e=>{let{row:t}=e;return eT(t.original.step_bytes_in)}},{accessorKey:"step_bytes_out",header:"BytesOut (MB)",cell:e=>{let{row:t}=e;return eT(t.original.step_bytes_out)}},{accessorKey:"step_response_time",header:"AvgResponseTime(ms)",cell:e=>{let{row:t}=e,a=t.original.step_response_time_averages;return Array.isArray(a)&&0!==a.length?(a.reduce((e,t)=>e+t,0)/a.length/1e6).toFixed(2):"-"}},{accessorKey:"p90",header:"P90(ms)",cell:e=>{let{row:t}=e;return eI(t.original.step_response_time)}},{accessorKey:"p95",header:"P95(ms)",cell:e=>{let{row:t}=e;return eC(t.original.step_response_time)}},{accessorKey:"p99",header:"P99(ms)",cell:e=>{let{row:t}=e;return eP(t.original.step_response_time)}}],p=q({data:d,columns:x,getRowId:(e,t)=>null!=e.vu_id?e.vu_id.toString():"row-".concat(t)}),f=q({data:u,columns:g,getRowId:(e,t)=>null!=e.vu_id&&null!=e.step_name?"".concat(e.vu_id,"-").concat(e.step_name):e.step_name?e.step_name+"-"+t:"row-"+t});return t&&0!==t.length?(0,s.jsxs)("div",{className:"w-full bg-orange-50 border border-orange-200 rounded-lg overflow-hidden",children:[(0,s.jsx)("div",{className:"p-4 border-b border-orange-200 bg-orange-100",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-orange-900",children:"Load Test Data"}),(0,s.jsx)("p",{className:"text-sm text-orange-700",children:"virtual-users"===i?"".concat(d.length," Virtual Users"):"".concat(h.length," Unique Steps")})]}),(0,s.jsx)(W,{value:i,onValueChange:e=>o(e),className:"w-fit",children:(0,s.jsxs)(Q,{children:[(0,s.jsx)(X,{value:"virtual-users",children:"Virtual Users"}),(0,s.jsx)(X,{value:"steps",children:"Steps"})]})})]})}),(0,s.jsxs)("div",{className:"relative flex flex-col",children:[(0,s.jsx)("div",{className:"overflow-hidden px-2",children:"virtual-users"===i?(0,s.jsx)(ed,{dndEnabled:!0,table:p,columns:x,onReorder:c}):(0,s.jsx)(ed,{dndEnabled:!0,table:f,columns:g,onReorder:m})}),(0,s.jsx)("div",{className:"p-4 border-t border-orange-200 bg-orange-100",children:"virtual-users"===i?(0,s.jsx)(eA,{table:p}):(0,s.jsx)(eA,{table:f})})]})]}):(0,s.jsx)("div",{className:"w-full bg-orange-50 border border-orange-200 rounded-lg p-8 text-center text-orange-600",children:"No VU data available"})}var ez=a(8247),eO=a(3406),eD=a(7156);function eY(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:c("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function eM(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:c("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function eV(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:c("leading-none font-semibold",t),...a})}function eR(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:c("text-muted-foreground text-sm",t),...a})}function eU(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:c("px-6",t),...a})}var eL=a(3540),eK=a(8124),eF=a(2319);let eJ={light:"",dark:".dark"},eG=r.createContext(null);function eH(e){let{id:t,className:a,children:n,config:l,...i}=e,o=r.useId(),d="chart-".concat(t||o.replace(/:/g,""));return(0,s.jsx)(eG.Provider,{value:{config:l},children:(0,s.jsxs)("div",{"data-slot":"chart","data-chart":d,className:c("[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",a),...i,children:[(0,s.jsx)(eq,{id:d,config:l}),(0,s.jsx)(eL.u,{children:n})]})})}let eq=e=>{let{id:t,config:a}=e,r=Object.entries(a).filter(e=>{let[,t]=e;return t.theme||t.color});return r.length?(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(eJ).map(e=>{let[a,s]=e;return"\n".concat(s," [data-chart=").concat(t,"] {\n").concat(r.map(e=>{var t;let[s,r]=e,n=(null==(t=r.theme)?void 0:t[a])||r.color;return n?"  --color-".concat(s,": ").concat(n,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},eB=eK.m;function eW(e){let{active:t,payload:a,className:n,indicator:l="dot",hideLabel:i=!1,hideIndicator:o=!1,label:d,labelFormatter:u,labelClassName:m,formatter:h,color:x,nameKey:g,labelKey:p}=e,{config:f}=function(){let e=r.useContext(eG);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}(),v=r.useMemo(()=>{var e;if(i||!(null==a?void 0:a.length))return null;let[t]=a,r="".concat(p||(null==t?void 0:t.dataKey)||(null==t?void 0:t.name)||"value"),n=eQ(f,t,r),l=p||"string"!=typeof d?null==n?void 0:n.label:(null==(e=f[d])?void 0:e.label)||d;return u?(0,s.jsx)("div",{className:c("font-medium",m),children:u(l,a)}):l?(0,s.jsx)("div",{className:c("font-medium",m),children:l}):null},[d,u,a,i,m,f,p]);if(!t||!(null==a?void 0:a.length))return null;let b=1===a.length&&"dot"!==l;return(0,s.jsxs)("div",{className:c("border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl",n),children:[b?null:v,(0,s.jsx)("div",{className:"grid gap-1.5",children:a.map((e,t)=>{let a="".concat(g||e.name||e.dataKey||"value"),r=eQ(f,e,a),n=x||(null==r?void 0:r.color)||e.color||e.stroke||e.fill||"hsl(var(--chart-".concat(t%5+1,"))");return(0,s.jsx)("div",{className:c("[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5","dot"===l&&"items-center"),children:h&&(null==e?void 0:e.value)!==void 0&&e.name?h(e.value,e.name,e,t,e.payload):(0,s.jsxs)(s.Fragment,{children:[(null==r?void 0:r.icon)?(0,s.jsx)(r.icon,{}):!o&&(0,s.jsx)("div",{className:c("shrink-0 rounded-[2px]",{"h-2.5 w-2.5":"dot"===l,"w-1":"line"===l,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===l,"my-0.5":b&&"dashed"===l}),style:{backgroundColor:"dashed"!==l?n:"transparent",borderColor:n,..."dashed"===l&&{borderStyle:"dashed"}}}),(0,s.jsxs)("div",{className:c("flex flex-1 justify-between leading-none",b?"items-end":"items-center"),children:[(0,s.jsxs)("div",{className:"grid gap-1.5",children:[b?v:null,(0,s.jsx)("span",{className:"text-muted-foreground",children:(null==r?void 0:r.label)||e.name})]}),e.value&&(0,s.jsx)("span",{className:"text-foreground font-mono font-medium tabular-nums",children:"number"==typeof e.value?e.value.toLocaleString():e.value})]})]})},e.dataKey||t)})})]})}function eQ(e,t,a){if("object"!=typeof t||null===t)return;let s="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,r=a;return a in t&&"string"==typeof t[a]?r=t[a]:s&&a in s&&"string"==typeof s[a]&&(r=s[a]),r in e?e[r]:e[a]}eF.s;var eX=a(2493);let eZ=(0,i.F)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}}),e$=r.createContext({size:"default",variant:"default"});function e0(e){let{className:t,variant:a,size:r,children:n,...l}=e;return(0,s.jsx)(eX.bL,{"data-slot":"toggle-group","data-variant":a,"data-size":r,className:c("group/toggle-group flex w-fit items-center rounded-md data-[variant=outline]:shadow-xs",t),...l,children:(0,s.jsx)(e$.Provider,{value:{variant:a,size:r},children:n})})}function e1(e){let{className:t,children:a,variant:n,size:l,...i}=e,o=r.useContext(e$);return(0,s.jsx)(eX.q7,{"data-slot":"toggle-group-item","data-variant":o.variant||n,"data-size":o.size||l,className:c(eZ({variant:o.variant||n,size:o.size||l}),"min-w-0 flex-1 shrink-0 rounded-none shadow-none first:rounded-l-md last:rounded-r-md focus:z-10 focus-visible:z-10 data-[variant=outline]:border-l-0 data-[variant=outline]:first:border-l",t),...i,children:a})}function e2(e){return Array.isArray(e)&&0!==e.length?e.reduce((e,t)=>e+t,0)/e.length:0}function e4(e){let{vuData:t=[],chartHistory:a,setChartHistory:n,isCompleted:l=!1}=e,[i,o]=r.useState("overall"),[d,c]=r.useState(!1),u=r.useRef("");r.useEffect(()=>{if(!Array.isArray(t)||0===t.length)return;if(l&&a.overall.length>0)return void console.log("Dashboard is completed and chart history exists, skipping chart updates");let e=JSON.stringify(t.map(e=>{var t;return{id:e.vu_id,stepCount:(null==(t=e.steps)?void 0:t.length)||0,timestamp:Date.now()}}));if(e===u.current)return;u.current=e;let s=Date.now(),r=[];t.forEach(e=>{var t;null==(t=e.steps)||t.forEach(e=>{Array.isArray(e.step_response_time)&&r.push(...e.step_response_time)})});let i=e2(r)/1e6,o=Array.from(new Set(t.flatMap(e=>{var t;return(null==(t=e.steps)?void 0:t.map(e=>e.step_name))||[]}))).filter(Boolean);n(e=>{let a={...e.perStep};o.forEach(e=>{let r=[];t.forEach(t=>{var a;null==(a=t.steps)||a.forEach(t=>{t.step_name===e&&Array.isArray(t.step_response_time)&&r.push(...t.step_response_time)})});let n=e2(r)/1e6;a[e]||(a[e]=[]),a[e]=[...a[e],{timestamp:s,value:n}]});let r=Array.from(new Set(t.map(e=>e.vu_id.toString()))),n={...e.perVU};return r.forEach(e=>{let a=[];t.forEach(t=>{if(t.vu_id.toString()===e){var s;null==(s=t.steps)||s.forEach(e=>{Array.isArray(e.step_response_time)&&a.push(...e.step_response_time)})}});let r=e2(a)/1e6;n[e]||(n[e]=[]),n[e]=[...n[e],{timestamp:s,value:r}]}),{overall:[...e.overall,{timestamp:s,avg_latency:i}],perStep:a,perVU:n}})},[t,l]);let h=r.useMemo(()=>{if("overall"===i)return a.overall.map(e=>({timestamp:e.timestamp,avg_latency:e.avg_latency}));if("perStep"===i){let e=Object.keys(a.perStep);return Array.from(new Set(e.flatMap(e=>(a.perStep[e]||[]).map(e=>e.timestamp)))).sort((e,t)=>e-t).map(t=>{let s={timestamp:t};return e.forEach(e=>{let r=(a.perStep[e]||[]).find(e=>e.timestamp===t);r&&(s[e]=r.value)}),s})}if("perVU"===i){let e=Object.keys(a.perVU);return Array.from(new Set(e.flatMap(e=>(a.perVU[e]||[]).map(e=>e.timestamp)))).sort((e,t)=>e-t).map(t=>{let s={timestamp:t};return e.forEach(e=>{let r=(a.perVU[e]||[]).find(e=>e.timestamp===t);r&&(s[e]=r.value)}),s})}return[]},[a,i]),x=r.useMemo(()=>{if("overall"===i)return{avg_latency:{label:"Avg Latency (ms)",color:"var(--chart-1)"}};if("perStep"===i){let e=Object.keys(a.perStep),t=["var(--chart-1)","var(--chart-2)","var(--chart-3)","var(--chart-4)","var(--chart-5)"];return Object.fromEntries(e.map((e,a)=>[e,{label:e,color:t[a%t.length]}]))}if("perVU"===i){let e=Object.keys(a.perVU),t=["var(--chart-1)","var(--chart-2)","var(--chart-3)","var(--chart-4)","var(--chart-5)"];return Object.fromEntries(e.map((e,a)=>[e,{label:"VU ".concat(e),color:t[a%t.length]}]))}return{}},[i,a]),g=r.useMemo(()=>"perStep"===i?Object.entries(a.perStep).map(e=>{let[t,a]=e;return{key:t,label:t,data:a.map(e=>({timestamp:e.timestamp,value:e.value}))}}):"perVU"===i?Object.entries(a.perVU).map(e=>{let[t,a]=e;return{key:t,label:"VU ".concat(t),data:a.map(e=>({timestamp:e.timestamp,value:e.value}))}}):[],[i,a]),p=d?g:g.slice(0,4);return t&&0!==t.length?(0,s.jsxs)(eY,{className:"@container/card",children:[(0,s.jsx)(eM,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(eV,{children:"Average Latency"}),(0,s.jsxs)(eR,{children:[(0,s.jsxs)("span",{className:"hidden @[540px]/card:block",children:["Latency by"," ","overall"===i?"All Steps":"perStep"===i?"Step":"VU"]}),(0,s.jsx)("span",{className:"@[540px]/card:hidden",children:"Latency"})]})]}),(0,s.jsxs)(e0,{type:"single",value:i,onValueChange:e=>e&&o(e),variant:"outline",className:"gap-2",children:[(0,s.jsx)(e1,{value:"overall",className:"text-xs transition-all ".concat("overall"===i?"bg-orange-100 text-orange-900 border-orange-300 shadow-sm":"hover:bg-oragne-50"),children:"Overall"}),(0,s.jsx)(e1,{value:"perStep",className:"text-xs transition-all ".concat("perStep"===i?"bg-orange-100 text-orange-900 border-orange-300 shadow-sm":"hover:bg-orange-50"),children:"Per Step"}),(0,s.jsx)(e1,{value:"perVU",className:"text-xs transition-all ".concat("perVU"===i?"bg-orange-100 text-orange-900 border-orange-300 shadow-sm":"hover:bg-orange-50"),children:"Per VU"})]})]})}),(0,s.jsx)(eU,{className:"px-2 pt-4 sm:px-6 sm:pt-6",children:(0,s.jsx)(eH,{config:x,className:"aspect-auto h-[250px] w-full",children:(0,s.jsxs)(ez.Q,{data:h,children:[(0,s.jsx)(eO.d,{vertical:!1}),(0,s.jsx)(eB,{cursor:!1,content:(0,s.jsx)(eW,{indicator:"line",hideLabel:!0})}),Object.keys(x).map(e=>(0,s.jsx)(eD.Gk,{dataKey:e,type:"natural",fill:x[e].color,fillOpacity:.3,stroke:x[e].color,strokeWidth:2,name:x[e].label||e},e))]})})}),("perStep"===i||"perVU"===i)&&g.length>0&&(0,s.jsxs)("div",{className:"px-4",children:[g.length>4&&(0,s.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-700",children:["Individual ","perStep"===i?"Step":"VU"," Charts",(0,s.jsxs)("span",{className:"text-gray-500 font-normal ml-1",children:["(",d?g.length:Math.min(4,g.length)," ","of ",g.length,")"]})]}),(0,s.jsx)(m,{variant:"outline",size:"sm",onClick:()=>c(!d),className:"text-xs cursor-pointer",children:d?"Show Less (4 of ".concat(g.length,")"):"Show All ".concat("perStep"===i?"Steps":"VUs"," (").concat(g.length,")")})]}),g.length<=4&&(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-700",children:["Individual ","perStep"===i?"Step":"VU"," Charts",(0,s.jsxs)("span",{className:"text-gray-500 font-normal ml-1",children:["(",g.length,")"]})]})}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:p.map((e,t)=>{let{key:a,label:r,data:n}=e,l=["var(--chart-1)","var(--chart-2)","var(--chart-3)","var(--chart-4)","var(--chart-5)"],i=l[t%l.length];return(0,s.jsxs)(eY,{className:"h-[180px] overflow-hidden",children:[(0,s.jsx)(eM,{children:(0,s.jsx)(eV,{className:"font-medium truncate leading-tight -m-2",title:r,children:r})}),(0,s.jsx)(eU,{className:"px-3",children:(0,s.jsx)("div",{className:"h-[130px] w-full",children:(0,s.jsx)(eH,{config:{value:{label:r,color:i}},className:"h-full w-full",children:(0,s.jsxs)(ez.Q,{data:n,margin:{top:20,right:2,left:2,bottom:20},children:[(0,s.jsx)(eB,{cursor:!1,content:(0,s.jsx)(eW,{indicator:"dot"})}),(0,s.jsx)(eD.Gk,{type:"natural",dataKey:"value",fill:i,fillOpacity:.4,stroke:i,strokeWidth:1.5,name:x[a].label||a})]})})})})]},a)})}),g.length>4&&(0,s.jsx)("div",{className:"mt-4 flex justify-center",children:(0,s.jsx)(m,{variant:"outline",size:"sm",onClick:()=>c(!d),className:"text-xs cursor-pointer",children:d?"Show Less (4 of ".concat(g.length,")"):"Show All ".concat("perStep"===i?"Steps":"VUs"," (").concat(g.length,")")})})]})]}):(0,s.jsxs)(eY,{className:"w-full",children:[(0,s.jsxs)(eM,{children:[(0,s.jsx)(eV,{children:"Average Latency"}),(0,s.jsx)(eR,{children:"No data available"})]}),(0,s.jsx)(eU,{className:"h-[250px] flex items-center justify-center text-gray-500",children:"No data is available"})]})}let e5=(0,i.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function e6(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:c(e5({variant:a}),t),...r})}var e3=a(646),e9=a(4861),e8=a(1243),e7=a(6785),te=a(4186);function tt(e){let{securityReport:t}=e,[a,n]=(0,r.useState)(new Set),l=e=>{switch(e.toLowerCase()){case"critical":return"bg-red-600 text-white";case"high":return"bg-red-500 text-white";case"medium":return"bg-yellow-500 text-white";case"low":return"bg-blue-500 text-white";case"info":return"bg-gray-500 text-white";default:return"bg-gray-400 text-white"}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(M.A,{className:"w-10 h-10 text-orange-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-orange-900",children:"Security Report"}),(0,s.jsxs)("p",{className:"text-orange-700",children:["Test Suite: ",t.test_suite]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsx)(eY,{className:"p-4 border-orange-200",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(e7.A,{className:"w-5 h-5 text-orange-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-orange-900",children:t.total_checks}),(0,s.jsx)("div",{className:"text-sm text-orange-600",children:"Total Checks"})]})]})}),(0,s.jsx)(eY,{className:"p-4 border-green-200",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(e3.A,{className:"w-5 h-5 text-green-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-700",children:t.passed}),(0,s.jsx)("div",{className:"text-sm text-green-600",children:"Passed"})]})]})}),(0,s.jsx)(eY,{className:"p-4 border-red-200",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(e9.A,{className:"w-5 h-5 text-red-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-red-700",children:t.failed}),(0,s.jsx)("div",{className:"text-sm text-red-600",children:"Failed"})]})]})}),(0,s.jsx)(eY,{className:"p-4 border-yellow-200",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(e8.A,{className:"w-5 h-5 text-yellow-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-yellow-700",children:t.warnings}),(0,s.jsx)("div",{className:"text-sm text-yellow-600",children:"Warnings"})]})]})})]}),(0,s.jsx)(eY,{className:"p-4 border-orange-200",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(te.A,{className:"w-4 h-4 text-orange-600"}),(0,s.jsx)("span",{className:"text-sm font-medium text-orange-900",children:"Report Generated"})]}),(0,s.jsx)("p",{className:"text-orange-700",children:new Date(t.timestamp).toLocaleString()})]}),Object.keys(t.summary).length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-orange-900 mb-3",children:"Severity Summary"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(t.summary).map(e=>{let[t,a]=e;return(0,s.jsxs)(e6,{className:l(t),children:[t,": ",a]},t)})})]})]})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-orange-900",children:"Security Check Results by Step"}),t.steps.map((e,t)=>{let r="".concat(e.step_method,"-").concat(e.step_name),i=a.has(r);return(0,s.jsxs)(eY,{className:"border-l-4 ".concat(e.failed>0?"border-l-red-500 border-red-200":e.warnings>0?"border-l-yellow-500 border-yellow-200":"border-l-green-500 border-green-200"),children:[(0,s.jsx)("div",{className:"p-4 cursor-pointer",onClick:()=>{n(e=>{let t=new Set(e);return t.has(r)?t.delete(r):t.add(r),t})},children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[i?(0,s.jsx)(ef.A,{className:"w-5 h-5 text-orange-600"}):(0,s.jsx)(em.A,{className:"w-5 h-5 text-orange-600"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"font-semibold text-orange-900",children:[e.step_method," - ",e.step_name]}),(0,s.jsx)("p",{className:"text-sm text-orange-700 break-all",children:e.step_url})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(e6,{className:"bg-green-100 text-green-800 border-green-200",children:["Passed: ",e.passed]}),(0,s.jsxs)(e6,{className:"bg-red-100 text-red-800 border-red-200",children:["Failed: ",e.failed]}),(0,s.jsxs)(e6,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:["Warnings: ",e.warnings]})]})]})}),i&&(0,s.jsx)("div",{className:"border-t border-orange-200 p-4 space-y-4",children:e.results.map((e,t)=>(0,s.jsxs)("div",{className:"bg-orange-50 p-4 rounded-md space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(e=>{switch(e){case"passed":return(0,s.jsx)(e3.A,{className:"w-4 h-4 text-green-600"});case"failed":return(0,s.jsx)(e9.A,{className:"w-4 h-4 text-red-600"});case"warning":return(0,s.jsx)(e8.A,{className:"w-4 h-4 text-yellow-600"});default:return(0,s.jsx)(M.A,{className:"w-4 h-4 text-gray-600"})}})(e.status),(0,s.jsx)("h5",{className:"font-semibold text-orange-900",children:e.check_name})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(e6,{className:(e=>{switch(e){case"passed":return"bg-green-100 text-green-800 border-green-200";case"failed":return"bg-red-100 text-red-800 border-red-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.status),children:e.status}),(0,s.jsx)(e6,{className:l(e.severity),children:e.severity})]})]}),(0,s.jsx)("p",{className:"text-orange-700",children:e.description}),(0,s.jsx)("div",{className:"bg-white p-3 rounded-md",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-orange-900",children:"Check ID:"})," ",(0,s.jsx)("span",{className:"text-orange-700",children:e.check_id})]}),e.status_code&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-orange-900",children:"Status Code:"})," ",(0,s.jsx)("span",{className:"text-orange-700",children:e.status_code})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-orange-900",children:"Target:"})," ",(0,s.jsx)("span",{className:"text-orange-700 capitalize",children:e.target})]})]})}),e.details&&(0,s.jsxs)("div",{className:"bg-gray-50 p-3 rounded-md",children:[(0,s.jsx)("h6",{className:"font-medium text-orange-900 mb-1",children:"Details"}),(0,s.jsx)("p",{className:"text-sm text-orange-700",children:e.details})]}),e.recommendation&&(0,s.jsxs)("div",{className:"bg-blue-50 p-3 rounded-md",children:[(0,s.jsx)("h6",{className:"font-medium text-orange-900 mb-1",children:"Recommendation"}),(0,s.jsx)("p",{className:"text-sm text-orange-700",children:e.recommendation})]})]},t))})]},t)})]})]})}var ta=a(3786),ts=a(2525),tr=a(9074),tn=a(7580);function tl(){let e=(0,n.useRouter)(),[t,a]=(0,r.useState)([]);return(0,r.useEffect)(()=>{let e=localStorage.getItem("klt-dashboards");if(e)try{let t=JSON.parse(e);a(t)}catch(e){console.error("Failed to parse saved dashboards:",e)}},[]),(0,s.jsx)("div",{className:"min-h-screen p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-orange-900 mb-2",children:"KLT Dashboard"}),(0,s.jsx)("p",{className:"text-orange-700 text-lg",children:"Manage and monitor your load testing dashboards"})]}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"text-sm text-orange-600",children:[t.length," dashboard",1!==t.length?"s":""," available"]})}),0===t.length?(0,s.jsxs)(eY,{className:"p-12 text-center border-orange-200",children:[(0,s.jsx)("div",{className:"text-orange-400 mb-4",children:(0,s.jsx)(Y.A,{className:"w-16 h-16 mx-auto mb-4"})}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-orange-800 mb-2",children:"No dashboards available"}),(0,s.jsx)("p",{className:"text-orange-600 mb-6",children:"Dashboards will appear here automatically when load tests are running"})]}):(0,s.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:t.map(t=>(0,s.jsxs)(eY,{className:"p-6 hover:shadow-lg transition-shadow border-orange-200 hover:border-orange-300",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-orange-900 truncate",children:t.title}),(0,s.jsx)("p",{className:"text-sm text-orange-500 mt-1",children:t.id})]}),(0,s.jsxs)("div",{className:"flex gap-2 ml-2",children:[(0,s.jsx)(m,{variant:"ghost",size:"sm",onClick:()=>(e=>{let t=new URL(window.location.origin);t.searchParams.set("dashboard",e),window.open(t.toString(),"_blank")})(t.id),className:"p-2 text-orange-600 hover:text-orange-700 hover:bg-orange-50",children:(0,s.jsx)(ta.A,{className:"w-4 h-4"})}),(0,s.jsx)(m,{variant:"ghost",size:"sm",onClick:()=>(e=>{a(t=>{let a=t.filter(t=>t.id!==e);return localStorage.setItem("klt-dashboards",JSON.stringify(a)),a});try{localStorage.removeItem("dashboard-storage-dashboard-".concat(e))}catch(e){console.error("Failed to clean up dashboard data:",e)}})(t.id),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,s.jsx)(ts.A,{className:"w-4 h-4"})})]})]}),(0,s.jsx)("p",{className:"text-orange-700 text-sm mb-4 line-clamp-2",children:t.description}),(0,s.jsxs)("div",{className:"space-y-2 mb-4 text-sm text-orange-600",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(tr.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:new Date(t.created_at).toLocaleString()})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(tn.A,{className:"w-4 h-4"}),(0,s.jsxs)("span",{children:[t.load_options.VUs," VUs"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(te.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:t.load_options.Duration})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(e7.A,{className:"w-4 h-4"}),(0,s.jsxs)("span",{children:[t.load_options.RPS," RPS"]})]})]}),(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsx)(m,{onClick:()=>{var a;return a=t.id,void e.push("/?dashboard=".concat(a))},className:"w-full bg-orange-600 hover:bg-orange-700 text-white",children:"Open Dashboard"})})]},t.id))})]})})}function ti(){let{selectedDashboard:e,setSelectedDashboard:t}=L(),[a,n]=(0,r.useState)("dashboard"),[l,i]=(0,r.useState)({}),[o,d]=(0,r.useState)({}),[c,u]=(0,r.useState)({}),[m,h]=(0,r.useState)({}),[x,p]=(0,r.useState)({}),[f,v]=(0,r.useState)(!1),y=(null==e?void 0:e.id)||"",N=l[y]||[],_=o[y]||{overall:[],perStep:{},perVU:{}},S=(0,r.useRef)(l),k=(0,r.useRef)(o),A=(0,r.useRef)(c),C=(0,r.useRef)(m),I=(0,r.useRef)(x);(0,r.useEffect)(()=>{S.current=l,k.current=o,A.current=c,C.current=m,I.current=x},[l,o,c,m,x]);let P=(e,t)=>"".concat(e,"-dashboard-").concat(t),T=e=>{let t=new Date(e).getTime();var a=Math.max(0,Math.floor((Date.now()-t)/1e3));let s=Math.floor(a/3600),r=Math.floor(a%3600/60),n=a%60;return s>0?"".concat(s,"h ").concat(r,"m ").concat(n,"s"):r>0?"".concat(r,"m ").concat(n,"s"):"".concat(n,"s")},E=(e,t)=>{u(a=>({...a,[e]:t}))};(0,r.useEffect)(()=>{(()=>{if(!(null==e?void 0:e.id))return v(!1);try{let t=P("dashboard-storage",e.id),a=localStorage.getItem(t);if(a){let e=JSON.parse(a);i(t=>({...t,...e.dashboardData})),d(t=>({...t,...e.chartHistories})),u(t=>({...t,...e.dashboardStopTimes})),h(t=>({...t,...e.dashboardCloseTimes})),p(t=>({...t,...e.dashboardOpenedStatus}))}}catch(e){}finally{v(!0)}})()},[null==e?void 0:e.id]),(0,r.useEffect)(()=>{if(!(null==e?void 0:e.id)||!f)return;let t=e.id;x[t]||(p(e=>({...e,[t]:!0})),z(e.url).then(e=>{if(e)h(e=>{let a={...e};return delete a[t],a});else{let e=m[t];e?E(t,e):E(t,"0s"),h(e=>{let a={...e};return delete a[t],a})}}))},[null==e?void 0:e.id,x,null==e?void 0:e.url,f]);let z=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let a=0;a<=t;a++)try{if(0===a){let e=sessionStorage.getItem("sw-unregistered");e&&Date.now()-parseInt(e)<3e3&&await new Promise(e=>setTimeout(e,300))}let t=await fetch(e,{cache:"no-store",signal:AbortSignal.timeout(2e3+500*a)});if(t.ok)return!0;if(t.status>=400&&t.status<500)break}catch(e){if(a===t)return!1;await new Promise(e=>setTimeout(e,500*(a+1)))}return!1};(0,r.useEffect)(()=>{if(!(null==e?void 0:e.id)||!(null==e?void 0:e.created_at)||!(null==e?void 0:e.url)||!f)return;let t=e.id;if(!c[t]){if(m[t]&&x[t])(async()=>{if(!await z(e.url)){let e=m[t];E(t,e),h(e=>{let a={...e};return delete a[t],a})}})();else if(x[t]){let a=setInterval(async()=>{if(!await z(e.url)&&!c[t]){let a=(null==e?void 0:e.id)===t,s=m[t];E(t,a?T(e.created_at):s||T(e.created_at)),s&&!a&&h(e=>{let a={...e};return delete a[t],a})}},1e4);return()=>clearInterval(a)}}},[e,c,m,x,f]);let O=(0,r.useRef)(null);(0,r.useEffect)(()=>{let t=O.current;if((null==t?void 0:t.id)&&t.id!==(null==e?void 0:e.id)&&f){let e=t.id;if(!A.current[e])try{let a=T(t.created_at);h(t=>({...t,[e]:a}));let s=P("dashboard-storage",e),r=localStorage.getItem(s);if(r){let t=JSON.parse(r);t.dashboardCloseTimes={...t.dashboardCloseTimes,[e]:a},localStorage.setItem(s,JSON.stringify(t))}}catch(e){}}O.current=e},[null==e?void 0:e.id,f]),(0,r.useEffect)(()=>{if(!f)return;let t=Object.entries(m);if(0===t.length)return;let a=async()=>{for(let[a,s]of t){if(c[a]||(null==e?void 0:e.id)===a||!x[a])continue;let t=JSON.parse(localStorage.getItem("klt-dashboards")||"[]").find(e=>e.id===a);(null==t?void 0:t.url)&&(await z(t.url)||(E(a,s),h(e=>{let t={...e};return delete t[a],t})))}};a();let s=setInterval(a,15e3);return()=>clearInterval(s)},[m,c,null==e?void 0:e.id,f]),(0,r.useEffect)(()=>{if(null==e?void 0:e.id)try{let t=P("dashboard-storage",e.id);localStorage.setItem(t,JSON.stringify({dashboardData:l,chartHistories:o,dashboardStopTimes:c,dashboardCloseTimes:m,dashboardOpenedStatus:x}))}catch(e){}},[l,o,c,m,x,null==e?void 0:e.id]),(0,r.useEffect)(()=>{if(!(null==e?void 0:e.id)||!(null==e?void 0:e.created_at))return;let t=()=>{if(!A.current[e.id])try{let t=T(e.created_at);h(a=>({...a,[e.id]:t}));let a=P("dashboard-storage",e.id),s=localStorage.getItem(a);if(s){let r=JSON.parse(s);r.dashboardCloseTimes={...r.dashboardCloseTimes,[e.id]:t},r.dashboardOpenedStatus={...r.dashboardOpenedStatus,[e.id]:!0},localStorage.setItem(a,JSON.stringify(r))}}catch(e){}};return window.addEventListener("beforeunload",t),()=>window.removeEventListener("beforeunload",t)},[null==e?void 0:e.id,null==e?void 0:e.created_at]);let D=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return[];for(let a=0;a<=t;a++)try{if(0===a){let e=sessionStorage.getItem("sw-unregistered");e&&Date.now()-parseInt(e)<3e3&&await new Promise(e=>setTimeout(e,200))}let t=await fetch(e,{cache:"no-store",signal:AbortSignal.timeout(3e3+500*a)});if(!t.ok)throw Error("HTTP ".concat(t.status,": ").concat(t.statusText));let s=await t.json();if(!Array.isArray(s))return[];let r=[],n=[];return s.forEach((e,t)=>{if(!e||"number"!=typeof e.vu_id)return void n.push({index:t,item:e,reason:"Missing or invalid vu_id"});let a=w.safeParse(e);a.success?r.push(a.data):n.push({index:t,item:{vu_id:e.vu_id},reason:"Schema validation failed",errors:a.error.issues})}),r}catch(e){if(a===t)return[];await new Promise(e=>setTimeout(e,500*(a+1)))}return[]};(0,r.useEffect)(()=>{var t;let a;if(!(null==e?void 0:e.url)||!f)return;let s=!!c[y],r=!!A.current[y],n=!!(null==(t=l[y])?void 0:t.length)&&(s||r);if(s||r||n)return;let o=!0,d=0,u=async()=>{var t;let s=A.current[y]||c[y];if(s||(null==(t=S.current[y])?void 0:t.length)>0&&s)return void clearInterval(a);try{let t=await D(e.url);if(A.current[y]||c[y])return void clearInterval(a);o&&(Array.isArray(t)&&t.length>0?(i(e=>({...e,[y]:t})),d=0):d++)}catch(e){d++}if(d>=3&&a&&(clearInterval(a),!A.current[y])){let t=I.current[y],a=C.current[y],s=(null==e?void 0:e.id)===y;E(y,s&&(null==e?void 0:e.created_at)?T(e.created_at):a&&t?a:t&&(null==e?void 0:e.created_at)?T(e.created_at):"0s"),a&&t&&!s&&h(e=>{let t={...e};return delete t[y],t})}};return u(),a=setInterval(u,1e3),()=>{o=!1,a&&clearInterval(a)}},[e,y,c,f]);let Y=N.length,M=!!c[y];return(0,s.jsxs)(g,{children:[(0,s.jsx)(V,{selectedDashboard:e,onSelectDashboard:t,onDashboardDeleted:a=>{i(e=>{let t={...e};return delete t[a],t}),d(e=>{let t={...e};return delete t[a],t}),u(e=>{let t={...e};return delete t[a],t}),h(e=>{let t={...e};return delete t[a],t}),p(e=>{let t={...e};return delete t[a],t}),(null==e?void 0:e.id)===a&&t(null)},currentView:a,onViewChange:n}),(0,s.jsxs)(j,{children:[(0,s.jsxs)("header",{className:"flex h-12 items-center gap-2 border-b px-4",children:[(0,s.jsx)(b,{className:"text-orange-900"}),(0,s.jsxs)("h1",{className:"text-lg font-semibold text-orange-900",children:["KLT Dashboard","security"===a&&" - Security Report"]}),e&&(0,s.jsxs)("span",{className:"text-xs text-orange-500 ml-auto",children:["Dashboard: ",e.id]})]}),(0,s.jsx)("div",{className:"p-6",children:"dashboard"===a?(0,s.jsxs)("div",{className:"@container/main flex flex-col gap-4 md:gap-6",children:[(0,s.jsx)(K,{lttoken:null!=e?e:void 0,stopped:M,stopTime:c[y],currentVUCount:Y}),(0,s.jsx)(e4,{vuData:N,chartHistory:_,setChartHistory:e=>{d(t=>({...t,[y]:e(t[y]||{overall:[],perStep:{},perVU:{}})}))},isCompleted:M}),(0,s.jsx)(eE,{data:N,isCompleted:M})]}):"security"===a&&(null==e?void 0:e.security_report)?(0,s.jsx)(tt,{securityReport:e.security_report}):(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"text-center text-orange-600",children:(0,s.jsx)("p",{children:"No security report available for this dashboard."})})})})]})]})}function to(){let{selectedDashboard:e,setSelectedDashboard:t}=L(),a=(0,n.useSearchParams)(),[l,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)(null),c=()=>{try{let e=localStorage.getItem("klt-dashboards");if(e)return JSON.parse(e)}catch(e){}return[]},u=e=>{try{let t=c(),a=t.findIndex(t=>t.id===e.id);a>=0?t[a]=e:t.unshift(e),localStorage.setItem("klt-dashboards",JSON.stringify(t))}catch(e){}},m=e=>{let a=c().find(t=>t.id===e);return!!a&&(t(a),!0)};(0,r.useEffect)(()=>{if(l){let t=setTimeout(()=>{i(!1),e||o||d("Request timed out. Using cached data if available.")},1e4);return()=>clearTimeout(t)}},[l,e,o]);let h=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;i(!0),d(null);try{for(let s=0;s<=a;s++)try{if(0===s){let e=sessionStorage.getItem("sw-unregistered");e&&Date.now()-parseInt(e)<3e3&&await new Promise(e=>setTimeout(e,500))}let a=localStorage.getItem("disable-sw");localStorage.setItem("disable-sw","true");let r=await fetch("http://localhost:2345/dashboards",{cache:"no-store",signal:AbortSignal.timeout(3e3+1e3*s)});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));let n=await r.json();if(n&&n.id&&(u(n),n.id===e&&t(n)),null===a?localStorage.removeItem("disable-sw"):localStorage.setItem("disable-sw",a),n.id===e)return;throw Error("Dashboard ID mismatch: expected ".concat(e,", got ").concat(n.id))}catch(t){let e=localStorage.getItem("disable-sw");if("true"===e&&localStorage.removeItem("disable-sw"),s===a)throw t;await new Promise(e=>setTimeout(e,500*(s+1)))}}catch(t){d(t instanceof Error?t.message:"Failed to fetch dashboard"),m(e)?d(null):d("Dashboard token unavailable. The server may have closed after serving the initial request.")}finally{i(!1)}};return((0,r.useEffect)(()=>{let s=null==a?void 0:a.get("dashboard");if(s){if((null==e?void 0:e.id)===s)return;m(s)?setTimeout(()=>{h(s).catch(()=>{})},100):h(s)}else t(null)},[null==a?void 0:a.get("dashboard")]),null==a?void 0:a.get("dashboard"))?l?(0,s.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,s.jsx)("div",{className:"text-orange-900",children:"Loading dashboard..."})}):o&&!e?(0,s.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center max-w-md",children:[(0,s.jsx)("div",{className:"text-red-600 mb-2",children:"Failed to load dashboard"}),(0,s.jsx)("div",{className:"text-sm text-gray-600 mb-4",children:o}),o.includes("Dashboard token unavailable")&&(0,s.jsxs)("div",{className:"text-xs text-orange-600 bg-orange-50 p-3 rounded",children:[(0,s.jsx)("strong",{children:"Note:"})," The dashboard server only serves one request per session. If you've unregistered the service worker, the token may no longer be available. Try restarting the load test to generate a new token."]})]})}):(0,s.jsx)(ti,{}):(0,s.jsx)(tl,{})}function td(){return(0,s.jsx)(U,{children:(0,s.jsx)(r.Suspense,{fallback:(0,s.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,s.jsx)("div",{className:"text-orange-900",children:"Loading dashboard..."})}),children:(0,s.jsx)(to,{})})})}}},e=>{e.O(0,[547,441,964,358],()=>e(e.s=2769)),_N_E=e.O()}]);